--[[
  Mini.files 文件浏览器插件配置
  GitHub: https://github.com/nvim-mini/mini.files
  文档: https://nvim-mini.org/mini.nvim/readmes/mini-files.html

  Mini.files 是 mini.nvim 库中的一个轻量级文件浏览器模块，提供：
  - 简洁的文件/目录浏览界面
  - 通过编辑文本缓冲区来操作文件系统（创建、删除、重命名、复制、移动）
  - 可预览文件内容
  - 支持书签和多窗口导航

  使用方法：
  1. 打开文件浏览器：
     - Lua 命令：输入 :lua require('mini.files').open()
     - 或使用快捷键（需要在 keymaps.lua 中配置，例如 <Tab>）

  2. 导航操作（在文件浏览器中）：
     - <Right> / → : 进入目录或打开文件（保持浏览器打开）
     - <A-Right> / Alt+→ : 进入目录或打开文件（打开文件后关闭浏览器）
     - <Left> / ← : 返回父目录
     - <A-Left> / Alt+← : 返回父目录并修剪右侧分支
     - <A-Up> / Alt+↑ : 显示当前工作目录（扩展分支以包含 cwd）
     - Q : 关闭文件浏览器

  3. 文件操作（在文件浏览器中编辑文本）：
     - 创建文件：新建一行，输入文件名（如 "newfile.txt"）
     - 创建目录：新建一行，输入目录名后加 "/"（如 "newdir/"）
     - 删除文件/目录：删除整行
     - 重命名：修改文件名部分
     - 复制/移动：复制整行并粘贴到目标位置
     - 应用更改：按 "=" 键同步，然后在确认对话框按 "y" 确认

  4. 其他快捷键（使用默认映射，未在配置中覆盖）：
     - m + 字符 : 设置书签（如 "ma" 设置书签 'a'）
     - ' + 字符 : 跳转到书签（如 "'a" 跳转到书签 'a'）
     - '' : 返回跳转前的位置
     - = : 同步文件系统（应用编辑操作）
     - <BS> : 重置浏览器（回到锚点目录）
     - < : 修剪左侧分支
     - > : 修剪右侧分支
     - g? : 显示帮助信息
]]
return {
  -- 插件标识（可以是 'nvim-mini/mini.files' 或 'echasnovski/mini.nvim'）
  'nvim-mini/mini.files',

  -- 延迟加载（只在需要时加载）
  lazy = true,

  -- 配置函数
  config = function()
    require('mini.files').setup({
      --[[
        快捷键映射配置
        这些映射仅在文件浏览器缓冲区中生效
        使用空字符串 '' 可以禁用某个映射

        注意：这里使用的是方向键映射，而不是默认的 hjkl 键
        默认映射为：
        - close = 'q'
        - go_in = 'l'
        - go_in_plus = 'L'
        - go_out = 'h'
        - go_out_plus = 'H'
        - reveal_cwd = '@'
      ]]
      mappings = {
        -- 关闭文件浏览器
        -- 默认: 'q'

        -- 进入目录或打开文件（保持浏览器打开）
        -- 默认: 'l'
        -- 作用：如果光标在目录上，则展开目录；如果在文件上，则在缓冲区中打开文件

        -- 进入目录或打开文件（打开文件后关闭浏览器）
        -- 默认: 'L'
        -- 作用：与 go_in 相同，但打开文件后会自动关闭文件浏览器

        -- 返回父目录
        -- 默认: 'h'
        -- 作用：将焦点移到左侧的父目录窗口

        -- 返回父目录并修剪右侧分支
        -- 默认: 'H'
        -- 作用：与 go_out 相同，但会移除右侧的所有子目录窗口

        -- 显示当前工作目录
        -- 默认: '@'
        -- 作用：扩展当前分支以包含当前工作目录（如果不在当前分支中）
      },

      --[[
        窗口配置
        控制文件浏览器窗口的显示和行为
      ]]
      windows = {
        -- 是否启用预览功能
        -- true: 在光标悬停时显示文件/目录预览窗口
        -- false: 不显示预览（默认值）
        preview = true,

        -- 以下配置使用默认值，可根据需要添加：
        -- max_number: 最大并排显示的窗口数量（默认: math.huge，无限制）
        -- width_focus: 焦点窗口的宽度（默认: 50 列）
        -- width_nofocus: 非焦点窗口的宽度（默认: 15 列）
        -- width_preview: 预览窗口的宽度（默认: 25 列）
      },

      --[[
        其他可配置项（使用默认值，可根据需要添加）：

        options = {
          permanent_delete = true,  -- 是否永久删除（true）或移动到回收站（false）
          use_as_default_explorer = true,  -- 是否作为默认文件浏览器
        },

        content = {
          filter = nil,  -- 文件过滤函数（nil 使用默认过滤器，显示所有文件）
          prefix = nil,  -- 前缀格式化函数（nil 使用默认前缀，支持图标）
          sort = nil,    -- 排序函数（nil 使用默认排序：目录优先，然后按字母顺序）
        },
      ]]
    })
  end
}
